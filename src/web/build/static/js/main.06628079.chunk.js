(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1015:function(e,t){},1016:function(e,t){},1045:function(e,t){},1244:function(e,t){},1254:function(e,t){},1329:function(e,t){},1475:function(e,t){},1663:function(e,t,a){},1665:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(7),c=a.n(i),s=a(43),o=a(44),l=a(46),u=a(45),p=a(47),m=a(69),d=a(116),h=a(685),g=a(686),f=a(35),E={isSignin:!1,signinSuccessful:!1,error:null},v={isSignup:!1,signupSuccessful:!1,error:null},b={isFindUser:!1,findUserSuccessful:!1,data:[],error:null},y=a(709),S={receiverID:"",listFriend:[],listMessage:[],error:null,callingAPI:!1,titleName:""},I=Object(d.c)({signinReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SIGNIN_START":return Object(f.a)({},e,{isSignin:!0});case"SIGNIN_SUCCESSFUL":return Object(f.a)({},e,{isSignin:!1,signinSuccessful:!0});case"SIGNIN_FAIL":return Object(f.a)({},e,{isSignin:!1,error:t.err});case"SIGNIN_FAIL_HANDLE":return Object(f.a)({},e,{error:null});default:return e}},signupReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CLEAR_STATE":return{isSignup:!1,signupSuccessful:!1,error:null};case"SIGNUP_START":return Object(f.a)({},e,{isSignup:!0});case"SIGNUP_SUCCESSFUL":return Object(f.a)({},e,{isSignup:!1,signupSuccessful:!0});case"SIGNUP_FAIL":return Object(f.a)({},e,{isSignup:!1,error:t.err});case"SIGNUP_FAIL_HANDLE":return Object(f.a)({},e,{error:null});default:return e}},findUserReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FINDUSER_START":return Object(f.a)({},e,{isFindUser:!0});case"FINDUSER_SUCCESSFUL":return Object(f.a)({},e,{isFindUser:!1,findUserSuccessful:!0,data:t.result});case"FINDUSER_FAIL":return Object(f.a)({},e,{isFindUser:!1,error:t.err});case"FINDUSER_FAIL_HANDLE":return Object(f.a)({},e,{error:null});default:return e}},chatReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_TITLE_NAME":return Object(f.a)({},e,{titleName:t.titleName});case"SET_RECEIVER_ID":return Object(f.a)({},e,{receiverID:t.receiverID});case"SET_LIST_FRIEND":return Object(f.a)({},e,{listFriend:t.listFriend,callingAPI:!1});case"SET_LIST_MESSAGE":return Object(f.a)({},e,{listMessage:t.listMessage,callingAPI:!1});case"PUSH_MESSAGE":return Object(f.a)({},e,{listMessage:[].concat(Object(y.a)(e.listMessage),[t.arr]),callingAPI:!1});case"CALLING_API":return Object(f.a)({},e,{callingAPI:!0});case"FAIL":return Object(f.a)({},e,{error:t.err,callingAPI:!1});case"FAIL_HANDLE":return Object(f.a)({},e,{error:null});default:return e}}}),k=function(e,t){return"LOG_OUT"===t.type&&(e=void 0),I(e,t)},C=Object(h.createLogger)({timestamps:!0,duration:!0}),_=Object(d.e)(k,Object(d.d)(Object(d.a)(C,g.a))),O=a(708),j=a(119),R=a(99),w=a(282),N=a(102),D=a.n(N),x=a(62),L=a.n(x);function T(e,t){return function(a){a({type:"SIGNIN_START"}),function(e,t){return new Promise(function(a,n){var r={username:e,password:t};return D.a.post(L.a.api_url+"/users/login",r).then(function(e){if(0===e.data.status)return n(e.data.error.message);localStorage.setItem("userID",e.data.result.id),localStorage.setItem("accessToken",e.data.result.accessToken),localStorage.setItem("refreshToken",e.data.result.refreshToken),localStorage.setItem("username",e.data.result.username),a()}).catch(function(e){n(e)})})}(e,t).then(function(){a({type:"SIGNIN_SUCCESSFUL"})}).catch(function(e){a(function(e){return{type:"SIGNIN_FAIL",err:e}}(e))})}}var U=a(53),F=a.n(U),A=a(114),M=a.n(A),P=a(178),G=a.n(P),B=a(113),K=a.n(B),H=a(177),W=a.n(H),q=a(85),V=a.n(q),J=a(42),z=a.n(J),Y=a(18),$=a.n(Y),Q=a(41),X=a.n(Q),Z=a(141),ee=a.n(Z),te=a(179),ae=a.n(te),ne=a(219),re=a.n(ne),ie=a(180),ce=a.n(ie);function se(e,t,a,n,r){return function(i){i({type:"SIGNUP_START"}),function(e,t,a,n,r){return new Promise(function(i,c){var s={user:{username:e,password:t,full_name:a,phone:n,genre:r}};return D.a.post(L.a.api_url+"/users/create",s).then(function(e){if(1===e.data.status)return i();e.data.error.message.errmsg&&c(e.data.error.message.errmsg),c(e.data.error.message)}).catch(function(e){c(e)})})}(e,t,a,n,r).then(function(){i({type:"SIGNUP_SUCCESSFUL"})}).catch(function(e){i(oe(e))})}}function oe(e){return{type:"SIGNUP_FAIL",err:e}}var le=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={full_name:"",username:"",password:"",phone:"",genre:""},a.handleChange=function(e){a.setState({genre:e.target.value})},a.onClickSignUp=a.onClickSignUp.bind(Object(R.a)(a)),a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"onClickSignUp",value:function(){var e=this.state,t=e.full_name,a=e.username,n=e.password,r=e.phone,i=e.genre;this.props.createUser(a,n,t,r,i)}},{key:"render",value:function(){var e=this,t=this.props.classes;return this.props.signupReducer.error&&(alert("Register fail: you must input correct email and mobie phone format,   "+this.props.signupReducer.error),this.props.signup_fail_handle()),this.props.signupReducer.signupSuccessful&&(this.props.clear_state(),this.setState({full_name:"",username:"",password:"",phone:"",genre:""}),alert("Register successfully")),r.a.createElement("div",null,r.a.createElement(z.a,{variant:"h6",gutterBottom:!0,className:t.typeColor},"Register Form"),r.a.createElement("form",null,r.a.createElement(X.a,{container:!0,spacing:24},r.a.createElement(X.a,{item:!0,xs:12},r.a.createElement(ee.a,{required:!0,label:"Full name",fullWidth:!0,autoComplete:"billing full name",value:this.state.full_name,onChange:function(t){return e.setState({full_name:t.target.value})}})),r.a.createElement(X.a,{item:!0,xs:12},r.a.createElement(ee.a,{required:!0,id:"email",name:"email",label:"Email",fullWidth:!0,autoComplete:"billing email",value:this.state.username,onChange:function(t){return e.setState({username:t.target.value})}})),r.a.createElement(X.a,{item:!0,xs:12},r.a.createElement(ee.a,{required:!0,id:"password",name:"password",type:"password",label:"Password",color:"#e0e0e0",fullWidth:!0,autoComplete:"billing password",value:this.state.password,onChange:function(t){return e.setState({password:t.target.value})}})),r.a.createElement(X.a,{item:!0,xs:12},r.a.createElement(ee.a,{required:!0,id:"phone",name:"phone",label:"Phone",fullWidth:!0,autoComplete:"billing phone",value:this.state.phone,onChange:function(t){return e.setState({phone:t.target.value})}})),r.a.createElement(X.a,{item:!0,xs:12},r.a.createElement(re.a,{required:!0,component:"legend"},"Genre")),r.a.createElement(X.a,{item:!0,xs:12,sm:4},r.a.createElement(ae.a,{control:r.a.createElement(ce.a,{checked:"1"===this.state.genre,onChange:this.handleChange,value:"1",name:"radio-button-demo","aria-label":"B"}),label:"Male"})),r.a.createElement(X.a,{item:!0,xs:12,sm:4},r.a.createElement(ae.a,{control:r.a.createElement(ce.a,{checked:"2"===this.state.genre,onChange:this.handleChange,value:"2",name:"radio-button-demo","aria-label":"B"}),label:"Female"})),r.a.createElement(X.a,{item:!0,xs:12,sm:4},r.a.createElement(ae.a,{control:r.a.createElement(ce.a,{checked:"3"===this.state.genre,onChange:this.handleChange,value:"3",name:"radio-button-demo","aria-label":"B"}),label:"Other"})),r.a.createElement(F.a,{type:"submit",fullWidth:!0,variant:"contained",color:"inherit",className:t.submit,disabled:this.props.signupReducer.isSignup&&!this.props.signupReducer.signupSuccessful,onClick:this.onClickSignUp},"Sign Up"))))}}]),t}(r.a.Component),ue=Object(m.b)(function(e){return{signupReducer:e.signupReducer}},function(e){return{createUser:function(t,a,n,r,i){return e(se(t,a,n,r,i))},signup_fail:function(){return e(oe())},signup_fail_handle:function(){return e({type:"SIGNUP_FAIL_HANDLE"})},clear_state:function(){return e({type:"CLEAR_STATE"})}}})($()(function(e){return{submit:{marginTop:3*e.spacing.unit,opacity:"0.6"},typeColor:{color:"#e0e0e0",textAlign:"center"}}})(le)),pe=a(181),me=a.n(pe),de=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={username:"",password:"",openRegister:!1},a.onClickSignin=function(){var e=a.state,t=e.username,n=e.password;a.props.login(t,n)},a.onClickRegister=function(){a.setState({openRegister:!a.state.openRegister})},a.onClickSignin=a.onClickSignin.bind(Object(R.a)(a)),a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){localStorage.getItem("accessToken")&&this.props.history.push("/login")}},{key:"render",value:function(){var e=this,t=this.props.classes,a=t.hide;return a=this.state.openRegister?"":t.hide,this.props.signinReducer.error&&(alert("sign fail: "+this.props.signinReducer.error),this.props.signin_fail_handle()),this.props.signinReducer.signinSuccessful&&this.props.history.push("/home"),r.a.createElement("div",{className:t.background},r.a.createElement(M.a,null),r.a.createElement(z.a,{className:t.typeColor,style:{paddingTop:"5vh"},component:"h1",variant:"h4"},"Justice Music"),r.a.createElement("main",{className:t.main},r.a.createElement(V.a,{className:t.paper},r.a.createElement("img",{src:me.a,alt:"Smiley face",style:{height:"45px",width:"45px"}}),r.a.createElement(z.a,{className:t.typeColor,component:"h1",variant:"h5"},"Sign in"),r.a.createElement("form",{className:t.form},r.a.createElement(G.a,{required:!0,fullWidth:!0},r.a.createElement(W.a,null,"Email Address"),r.a.createElement(K.a,{id:"email",name:"email",autoComplete:"email",onChange:function(t){return e.setState({username:t.target.value})}})),r.a.createElement(G.a,{margin:"normal",required:!0,fullWidth:!0},r.a.createElement(W.a,null,"Password"),r.a.createElement(K.a,{name:"password",type:"password",id:"password",autoComplete:"current-password",onChange:function(t){return e.setState({password:t.target.value})}})),r.a.createElement(F.a,{type:"submit",fullWidth:!0,variant:"contained",color:"inherit",className:t.submit,disabled:this.props.signinReducer.isSignin&&!this.props.signinReducer.signinSuccessful,onClick:this.onClickSignin},"Sign in"),r.a.createElement(F.a,{onClick:this.onClickRegister,style:{backgroundColor:"#e0e0e0",marginTop:"30px",opacity:"0.5"}},"Register here"))),r.a.createElement(V.a,{className:[t.paper,a]},r.a.createElement(ue,null))),r.a.createElement(z.a,{className:t.typeColor,component:"h4",variant:"h6"},"Develop with",r.a.createElement("span",{role:"img","aria-label":"Love"}," \u2764\ufe0f "),"by Keyti"))}}]),t}(r.a.Component),he=Object(m.b)(function(e){return{signinReducer:e.signinReducer}},function(e){return{login:function(t,a){return e(T(t,a))},signin_fail_handle:function(){return e({type:"SIGNIN_FAIL_HANDLE"})}}})($()(function(e){return{background:{backgroundImage:"url(".concat(a(922),")"),backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"cover",height:"100vh"},main:Object(w.a)({width:"auto",display:"flex",justifyContent:"center"},e.breakpoints.up(400+3*e.spacing.unit*2),{width:"50%",marginLeft:"auto",marginRight:"auto"}),paper:{marginTop:8*e.spacing.unit,display:"flex",flexDirection:"column",alignItems:"center",padding:"".concat(2*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px ").concat(3*e.spacing.unit,"px"),backgroundColor:"transparent",width:"50%"},form:{width:"100%",marginTop:e.spacing.unit},submit:{marginTop:3*e.spacing.unit,opacity:"0.6"},typeColor:{color:"#e0e0e0",textAlign:"center"},hide:{display:"none"}}})(de)),ge=a(687),fe=a.n(ge),Ee=a(50),ve=a(136),be=a.n(ve),ye=a(285),Se=a.n(ye),Ie=a(84),ke=a.n(Ie),Ce=a(290),_e=a(284),Oe=a.n(_e),je=a(689),Re=a.n(je),we=a(140),Ne=a.n(we),De=a(63),xe=a.n(De);function Le(e){return function(t){t({type:"FINDUSER_START"}),function(e){return new Promise(function(t,a){return D.a.get(L.a.api_url+"/users/find",{params:{keyword:e}}).then(function(e){if(0===e.data.status)return a(e.data.error.message);t(e.data.result)}).catch(function(e){return a(e)})})}(e).then(function(e){t(function(e){return{type:"FINDUSER_SUCCESSFUL",result:e}}(e))}).catch(function(e){t(function(e){return{type:"FINDUSER_FAIL",err:e}}(e))})}}var Te=a(277),Ue=a.n(Te);var Fe=Object(Ee.withStyles)({card:{margin:"10px"},title:{fontSize:14,maxWidth:"50vw"},div:{display:"table"},sender:{display:"flex",justifyContent:"flex-end"},seen:{color:"#bdbdbd"}})(function(e){var t,a,n=e.classes;return!0===e.sender&&(t=n.sender),!0===e.seen&&(a="seen"),r.a.createElement("li",{className:t,style:{listStyleType:"none"}},r.a.createElement("div",{className:n.div},r.a.createElement(be.a,{className:n.card},r.a.createElement(Ue.a,{style:{paddingBottom:"16px"}},r.a.createElement(z.a,{className:n.title,color:"textSecondary",gutterBottom:!0},e.content))),r.a.createElement("div",{className:n.seen},a)))}),Ae=a(688),Me=a(139),Pe=a.n(Me),Ge=a(135),Be=a.n(Ge),Ke=a(137),He=a.n(Ke),We=a(138),qe=a.n(We),Ve=a(115),Je=a.n(Ve),ze=a(279),Ye=a.n(ze),$e=a(278),Qe=a.n($e),Xe=a(221),Ze=a.n(Xe),et=a(185),tt=a.n(et);function at(){return{"Content-Type":"application/json; charset=utf-8",Accept:"application/json","x-access-token":localStorage.getItem("accessToken")}}function nt(){return new Promise(function(e,t){var a={userID:localStorage.getItem("userID")};return D.a.post(L.a.api_url+"/chats/getListFriend",a,{headers:at()}).then(function(a){if(0===a.data.status)return t(a.data.error);e(a.data.result)}).catch(function(e){t(e)})})}function rt(){return function(e){e({type:"CALLING_API"}),nt().then(function(t){if(e(ct(t)),t.length>=1){var a=t[0]._id;e(it(a)),e(ot(a)),e(st(t[0].username))}}).catch(function(t){e(lt(t))})}}function it(e){return function(t){t({type:"CALLING_API"}),function(e){return new Promise(function(t,a){var n={senderID:localStorage.getItem("userID"),receiverID:e};return D.a.post(L.a.api_url+"/chats/getListMessage",n,{headers:at()}).then(function(e){if(0===e.data.status)return a(e.data.error.message);t(e.data.result)}).catch(function(e){a(e)})})}(e).then(function(e){t(function(e){return{type:"SET_LIST_MESSAGE",listMessage:e}}(e))}).catch(function(e){t(lt(e))})}}function ct(e){return{type:"SET_LIST_FRIEND",listFriend:e}}function st(e){return{type:"SET_TITLE_NAME",titleName:e}}function ot(e){return{type:"SET_RECEIVER_ID",receiverID:e}}function lt(e){return{type:"FAIL",err:e}}var ut={avatar:{backgroundColor:tt.a[100],color:tt.a[600]}},pt=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleClose=function(){a.props.onClose(a.props.selectedValue)},a.handleListItemClick=function(e,t){a.props.onClose(),a.props.set_title_name(t),a.props.getListMessage(e),a.props.select_user_to_chat(e)},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=(t.onClose,t.selectedValue,Object(Ae.a)(t,["classes","onClose","selectedValue"]));return r.a.createElement(Qe.a,Object.assign({onClose:this.handleClose,"aria-labelledby":"simple-dialog-title"},n),r.a.createElement(Ye.a,{id:"simple-dialog-title"},"List users"),r.a.createElement("div",null,r.a.createElement(Be.a,null,this.props.findUserReducer.data.map(function(t){return r.a.createElement(He.a,{button:!0,onClick:function(){return e.handleListItemClick(t._id,t.username)},key:t._id},r.a.createElement(qe.a,null,r.a.createElement(Pe.a,{className:a.avatar},r.a.createElement(Ze.a,null))),r.a.createElement(Je.a,{primary:t.username}))}))))}}]),t}(r.a.Component),mt=Object(m.b)(function(e){return{findUserReducer:e.findUserReducer,chatReducer:e.chatReducer}},function(e){return{getListFriend:function(){return e(rt())},getListMessage:function(t){return e(it(t))},select_user_to_chat:function(t){return e(ot(t))},set_title_name:function(t){return e(st(t))}}})(Object(Ee.withStyles)(ut)(pt)),dt={avatar:{backgroundColor:tt.a[100],color:tt.a[600]},onlineBar:{textAlign:"right"}},ht=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleListItemClick=function(e,t){a.props.getListMessage(e),a.props.select_user_to_chat(e),a.props.set_title_name(t)},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this,t=this.props.classes;return r.a.createElement("div",null,r.a.createElement(Be.a,null,this.props.chatReducer.listFriend.map(function(a){return a.socketID?r.a.createElement(He.a,{button:!0,onClick:function(){return e.handleListItemClick(a._id,a.username)},key:a._id},r.a.createElement(qe.a,null,r.a.createElement(Pe.a,{className:t.avatar},r.a.createElement(Ze.a,null))),r.a.createElement(Je.a,{primary:a.username}),r.a.createElement(Je.a,{primary:"online",className:t.onlineBar})):r.a.createElement(He.a,{button:!0,onClick:function(){return e.handleListItemClick(a._id,a.username)},key:a._id},r.a.createElement(qe.a,null,r.a.createElement(Pe.a,{className:t.avatar},r.a.createElement(Ze.a,null))),r.a.createElement(Je.a,{primary:a.username}))})))}}]),t}(r.a.Component),gt=Object(m.b)(function(e){return{chatReducer:e.chatReducer}},function(e){return{getListFriend:function(){return e(rt())},getListMessage:function(t){return e(it(t))},select_user_to_chat:function(t){return e(ot(t))},set_title_name:function(t){return e(st(t))}}})(Object(Ee.withStyles)(dt)(ht));var ft=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleClickSearch=function(){a.setState({open:!0}),a.props.findUser(a.state.searchText)},a.handleClose=function(){a.setState({open:!1})},a.onClickLogOut=function(e){a.socket.disconnect(),a.props.log_out(),localStorage.clear(),a.props.history.push("/login")},a.onFocusMessage=function(){var e=a.props.chatReducer.listMessage,t=e[e.length-1];if(t){var n={senderID:t.senderID,receiverID:t.receiverID};localStorage.getItem("userID")!==t.senderID&&a.socket.emit("is seen",n)}},a.handleClickSend=function(){if(a.state.content){var e={senderID:localStorage.getItem("userID"),receiverID:a.props.chatReducer.receiverID,content:a.state.content},t={senderID:localStorage.getItem("userID"),content:a.state.content,date_created:Date(Date.now())};a.props.chatReducer.listFriend.find(function(e){return e._id===a.props.chatReducer.receiverID})?a.socket.emit("chat message",e):(a.socket.emit("first message",e),a.socket.on("return friend",function(){a.props.getNewFriend()})),a.props.push_message(t),a.setState({content:""});var n=document.getElementById("inputMessage");n.scrollTop=n.scrollHeight,a.socket.emit("typing",Object(f.a)({},e,{isTyping:!1}))}},a.componentWillMount=function(){null===localStorage.getItem("accessToken")&&a.props.history.push("/login"),a.props.getListFriend();var e=localStorage.getItem("accessToken");a.socket=fe()(L.a.url,{query:{token:e}}),a.socket.on("error",function(e){alert("socket error"+e)}),a.socket.on("chat message",function(e){var t={senderID:e.senderID,receiverID:e.receiverID,content:e.content,date_created:Date(Date.now())};e.senderID===a.props.chatReducer.receiverID&&a.props.push_message(t)}),a.socket.on("first message",function(e){var t={senderID:e.senderID,receiverID:e.receiverID,content:e.content,date_created:Date(Date.now())};a.props.getListFriend(),e.senderID===a.props.chatReducer.receiverID&&a.props.push_message(t)}),a.socket.on("is seen",function(){a.props.getListMessage(a.props.chatReducer.receiverID)}),a.socket.on("typing",function(e){e.senderID===a.props.chatReducer.receiverID&&(!0===e.isTyping&&a.setState({typing:!0}),!1===e.isTyping&&a.setState({typing:!1}))})},a.state={open:!1,searchText:"",content:"",typing:!1},a.socket=null,a.handleKeyPressSearch=a.handleKeyPressSearch.bind(Object(R.a)(a)),a.handleKeyPressMessage=a.handleKeyPressMessage.bind(Object(R.a)(a)),a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"handleKeyPressSearch",value:function(e){"Enter"===e.key&&this.handleClickSearch()}},{key:"handleKeyPressMessage",value:function(e){var t={receiverID:this.props.chatReducer.receiverID,senderID:localStorage.getItem("userID")};"Enter"===e.key?this.handleClickSend(e):"Backspace"===e.key&&""===this.state.content&&this.socket.emit("typing",Object(f.a)({},t,{isTyping:!1}))}},{key:"onTyping",value:function(e){this.setState({content:e.target.value});var t={receiverID:this.props.chatReducer.receiverID,senderID:localStorage.getItem("userID")};0===this.state.content.length&&(this.onFocusMessage(),this.socket.emit("typing",Object(f.a)({},t,{isTyping:!0})))}},{key:"componentDidUpdate",value:function(){var e=document.getElementById("inputMessage");e.scrollTop=e.scrollHeight}},{key:"render",value:function(){var e=this,t=this.props.classes;return this.props.findUserReducer.error&&(alert("Find user fail: "+this.props.findUserReducer.error),this.props.signin_fail_handle()),r.a.createElement(X.a,{container:!0,spacing:0},r.a.createElement(X.a,{item:!0,xs:12,sm:3},r.a.createElement("div",{className:t.divTop,style:{borderRight:"1px solid #e0e0e0",justifyContent:"center"}},r.a.createElement(Ce.a,null,"Chat realtime"))),r.a.createElement(X.a,{item:!0,xs:12,sm:9},r.a.createElement("div",{className:t.divTop,style:{justifyContent:"space-between"}},r.a.createElement("div",null,r.a.createElement(xe.a,{style:{padding:5}},r.a.createElement(Oe.a,null)),localStorage.getItem("username")),r.a.createElement(z.a,{variant:"h6"},this.props.chatReducer.titleName),r.a.createElement(Ce.a,{onClick:this.onClickLogOut},"Log out"))),r.a.createElement(X.a,{item:!0,xs:12,sm:3},r.a.createElement("div",{className:t.divBottom,style:{borderRight:"1px solid #e0e0e0"}},r.a.createElement("div",{className:t.searchDiv},r.a.createElement(ke.a,{placeholder:"Search\u2026",classes:{root:t.inputSearchRoot,input:t.inputSearch},value:this.state.searchText,onChange:function(t){return e.setState({searchText:t.target.value})},onKeyPress:this.handleKeyPressSearch}),r.a.createElement(Ne.a,{className:t.divider}),r.a.createElement(xe.a,{type:"submit",variant:"outlined",className:t.iconButton,onClick:this.handleClickSearch,disabled:this.props.findUserReducer.isFindUser},r.a.createElement(Se.a,null)),r.a.createElement(mt,{className:t.findUser,open:this.state.open,onClose:this.handleClose})),r.a.createElement("div",null,r.a.createElement(be.a,{className:t.cardListFriend},r.a.createElement(gt,null))))),r.a.createElement(X.a,{item:!0,xs:12,sm:9},r.a.createElement("div",{className:t.divBottom},r.a.createElement(be.a,{className:t.cardMessage},r.a.createElement("div",{id:"inputMessage",style:{overflow:"auto"}},r.a.createElement("ul",null,this.props.chatReducer.listMessage.map(function(t){if(t.senderID===localStorage.getItem("userID")){var a=e.props.chatReducer.listMessage,n=a[a.length-1];return t===n&&!0===n.isSeen?r.a.createElement(Fe,{content:t.content,key:t._id,sender:!0,seen:!0}):r.a.createElement(Fe,{content:t.content,key:t._id,sender:!0})}return r.a.createElement(Fe,{content:t.content,key:t._id,sender:!1})}),r.a.createElement(z.a,{style:{color:"#bdbdbd"}},this.state.typing?"Typing.......":""))),r.a.createElement("div",null,r.a.createElement(V.a,{className:t.messageBar,elevation:4},r.a.createElement(ke.a,{className:t.input,onFocus:this.onFocusMessage,placeholder:"Message...",value:this.state.content,onChange:function(t){e.onTyping(t)},onKeyUp:this.handleKeyPressMessage}),r.a.createElement(Ne.a,{className:t.divider}),r.a.createElement(Ce.a,{color:"secondary",onClick:function(t){e.handleClickSend(t)}},"Send",r.a.createElement(Re.a,null))))))))}}]),t}(r.a.Component),Et=Object(m.b)(function(e){return{findUserReducer:e.findUserReducer,chatReducer:e.chatReducer,signinReducer:e.signinReducer}},function(e){return{findUser:function(t){return e(Le(t))},findUser_fail_handle:function(){return e({type:"FINDUSER_FAIL_HANDLE"})},getListFriend:function(){return e(rt())},getListMessage:function(t){return e(it(t))},push_message:function(t){return e(function(e){return{type:"PUSH_MESSAGE",arr:e}}(t))},getNewFriend:function(){return e(function(e){e({type:"CALLING_API"}),nt().then(function(t){e(ct(t))}).catch(function(t){e(lt(t))})})},log_out:function(){return e({type:"LOG_OUT"})}}})(Object(Ee.withStyles)(function(e){return{messageBar:{padding:"2px 4px",display:"flex",alignItems:"center",width:"100%"},divider:{width:1,height:40,margin:4},divTop:{padding:e.spacing.unit,display:"flex",flexDirection:"row",borderBottom:"1px solid #e0e0e0"},divBottom:{height:"calc(100vh - "+15*e.spacing.unit+"px)",padding:2*e.spacing.unit},searchDiv:{background:"#e0e0e0",borderRadius:6,color:"#212121",display:"flex",flexDirection:"row"},iconButton:{background:"#bdbdbd"},input:{marginLeft:8,flex:1},inputSearchRoot:{width:"100%"},inputSearch:{paddingLeft:e.spacing.unit},cardMessage:{borderRadius:"6px",height:"calc(100vh - "+13*e.spacing.unit+"px)",display:"flex",flexDirection:"column",justifyContent:"flex-end"},cardListFriend:{marginTop:2*e.spacing.unit,borderRadius:"6px",height:"calc(100vh - "+21*e.spacing.unit+"px)",overflow:"auto"},findUser:{overflow:"auto",height:"calc(100vh - "+21*e.spacing.unit+"px)"},typing:{display:"none"}}})(ft)),vt=a(706),bt=a.n(vt),yt=a(184),St=a.n(yt),It=a(707),kt=a.n(It),Ct=a(705),_t=a.n(Ct),Ot=a(1670),jt=a(1671),Rt=a(1672),wt=a(1673),Nt=a(1674),Dt=a(1675),xt=a(1667),Lt=a(1669),Tt=a(17),Ut=a(1676),Ft=a(1668),At=a(145);a(959);var Mt=a(690),Pt="updatable",Gt=Ot.a.create({name:"form_in_modal"})(function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={USD:0,costUSD:23e3},a.resetUSD=function(){a.setState({USD:0})},a.normFile=function(e){return console.log("Upload event:",e),Array.isArray(e)?e:(2===e.fileList.length&&(console.log("hahahaha"),e.fileList=e.fileList.slice(-1)),e&&e.fileList)},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.props.onRef(this)}},{key:"componentWillUnmount",value:function(){this.props.onRef(void 0)}},{key:"render",value:function(){var e=this,t=this.props,a=t.visible,n=t.onCancel,i=t.onCreate,c=t.form.getFieldDecorator,s=jt.a.Option;return r.a.createElement(Rt.a,{visible:a,title:"Upload media",okText:"Submit",onCancel:n,onOk:i},r.a.createElement(Ot.a,{layout:"vertical"},r.a.createElement(Ot.a.Item,{label:"Media's name"},c("name",{rules:[{required:!0,message:"Please input the name of this song!"}]})(r.a.createElement(wt.a,{placeholder:"Please select song's name"}))),r.a.createElement(Ot.a.Item,{label:"Genres"},c("genres",{initialValue:"Music"})(r.a.createElement(Nt.a.Group,null,r.a.createElement(Nt.a,{value:"Music"},"Music"),r.a.createElement(Nt.a,{value:"Image"},"Image")))),r.a.createElement(Ot.a.Item,{label:"Tags"},c("tags",{rules:[{message:"Please select song's tag ",type:"array"}]})(r.a.createElement(jt.a,{mode:"multiple",placeholder:"Please select song's tag"},r.a.createElement(s,{value:"Rap"},"Rap"),r.a.createElement(s,{value:"Rock"},"Rock"),r.a.createElement(s,{value:"young"},"Young"),r.a.createElement(s,{value:"pre-war"},"Pre-war"),r.a.createElement(s,{value:"lyrical"},"Lyrical"),r.a.createElement(s,{value:"US-UK"},"US-UK")))),r.a.createElement(Ot.a.Item,{label:"Price HAK"},c("price",{rules:[{required:!0,message:"Please input cost of this song!"}],initialValue:0,onChange:function(t){e.setState({USD:t/e.state.costUSD})}})(r.a.createElement(Dt.a,{min:0,max:1e10})),r.a.createElement("span",{className:"ant-form-text"}," HAK"),r.a.createElement("span",{className:"ant-form-text"},"\u279c   ",this.state.USD," USD")),r.a.createElement(Ot.a.Item,{label:"Contract permission"},c("contractPermission",{initialValue:!0,valuePropName:"checked"})(r.a.createElement(xt.a,null))),r.a.createElement(Ot.a.Item,{label:"Upload"},c("file",{valuePropName:"fileList",getValueFromEvent:this.normFile,rules:[{required:!0}]})(r.a.createElement(Lt.a.Dragger,{action:"https://www.mocky.io/v2/5cc8019d300000980a055e76"},r.a.createElement("p",{className:"ant-upload-drag-icon"},r.a.createElement(Tt.a,{type:"inbox"})),r.a.createElement("p",{className:"ant-upload-text"},"Click or drag file to this area to upload"))))))}}]),t}(r.a.Component)),Bt=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),c=0;c<n;c++)i[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={visible:!1},a.showModal=function(){a.setState({visible:!0})},a.handleCancel=function(){a.setState({visible:!1})},a.handleCreate=function(){var e=a.formRef.props.form;e.validateFields(function(t,n){a.openUploadNotification(t,n),console.log("Received values of form: ",n),e.resetFields(),a.child.resetUSD(),a.setState({visible:!1})})},a.saveFormRef=function(e){a.formRef=e},a.openUploadNotification=function(e,t){e?Ut.a.error({key:Pt,message:"Error",description:"This is error message: "+e,duration:0,placement:"bottomLeft"}):(Ut.a.open({key:Pt,message:"Uploading",description:r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},r.a.createElement(Ft.a,null),r.a.createElement("p",{style:{marginLeft:"15px"}},"System is uploading this media")),duration:0,placement:"bottomLeft"}),Object(Mt.a)(t.file[0].originFileObj).then(function(e){var a={fileHash:e,price:t.price,kind:"Music"===t.genres?2:1};console.log(a),function(e){return new Promise(function(t,a){return D.a.post(L.a.api_url+"/ethereums/upload",e,{headers:at()}).then(function(e){if(0===e.data.status)return a(e.data.error.message);console.log("this is result"+e.data.result),t(e.data.result)}).catch(function(e){a(e)})})}(a).then(function(e){Ut.a.open({key:Pt,message:"Pending Transaction",description:r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},r.a.createElement(Ft.a,null),r.a.createElement("p",{style:{marginLeft:"15px"}},"This Transaction is pending")),duration:0,placement:"bottomLeft"}),L.a.provider.waitForTransaction(e).then(function(e){Ut.a.success({key:Pt,message:"Sucess Transaction",description:"Transaction has been successful",duration:0,placement:"bottomLeft"}),console.log(e)})}).catch(function(e){Ut.a.error({key:Pt,message:"Error",description:"This is error message: "+e,duration:0,placement:"bottomLeft"})})}))},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(At.a,{type:"primary",onClick:this.showModal},"New Collection"),r.a.createElement(Gt,{wrappedComponentRef:this.saveFormRef,visible:this.state.visible,onCancel:this.handleCancel,onCreate:this.handleCreate,onRef:function(t){return e.child=t}}))}}]),t}(r.a.Component),Kt={root:{flexGrow:1},grow:{flexGrow:1},logo:{width:"37px",height:"30px"},appBar:{display:"flex",justifyContent:"center",alignItems:"center",borderBottom:"1px solid #e0e0e0"},searchDiv:{borderRadius:3,color:"#212121",display:"flex",flexDirection:"row",border:"1px solid #e0e0e0"},inputSearchRoot:{},inputSearch:{paddingLeft:"8px"},divider:{width:1,height:25,margin:4},iconButton:{padding:"5px",background:"#eeeeee"}},Ht=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleClickFileManager=function(){a.props.history.push("/fileManager")},a.handleClickMessage=function(){a.props.history.push("/message")},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.classes;return r.a.createElement("div",{className:e.root},r.a.createElement(M.a,null),r.a.createElement("div",null,r.a.createElement(X.a,{container:!0,spacing:8},r.a.createElement(X.a,{item:!0,xs:2,className:e.appBar},r.a.createElement(xe.a,{style:{padding:"0px"}},r.a.createElement("a",{href:"/home"},r.a.createElement("img",{src:me.a,alt:"Smiley face",className:e.logo}))),r.a.createElement(z.a,{variant:"h5"},"Justice Music")),r.a.createElement(X.a,{item:!0,xs:8,style:Kt.appBar},r.a.createElement(F.a,{color:"inherit",onClick:this.handleClickFileManager},"Songs"),r.a.createElement(F.a,{color:"inherit",onClick:this.handleClickFileManager},"Videos"),r.a.createElement(F.a,{color:"inherit",onClick:this.handleClickFileManager},"Artists"),r.a.createElement(F.a,{color:"inherit",onClick:this.handleClickFileManager},"Ranking"),r.a.createElement(F.a,{color:"inherit",onClick:this.handleClickFileManager},"Top 100"),r.a.createElement(F.a,{color:"inherit",onClick:this.handleClickFileManager},"Theme"),r.a.createElement(F.a,{color:"inherit",onClick:this.handleClickFileManager},"Events"),r.a.createElement(F.a,{color:"inherit",onClick:this.handleClickFileManager},"Music news"),r.a.createElement(F.a,{color:"inherit",onClick:this.handleClickFileManager},"ISO"),r.a.createElement("div",{className:e.searchDiv},r.a.createElement(ke.a,{placeholder:"Search\u2026",classes:{root:e.inputSearchRoot,input:e.inputSearch}}),r.a.createElement(Ne.a,{className:e.divider}),r.a.createElement(xe.a,{type:"submit",variant:"outlined",className:e.iconButton},r.a.createElement(Se.a,null)))),r.a.createElement(X.a,{item:!0,xs:2,className:e.appBar},r.a.createElement(xe.a,{color:"inherit"},r.a.createElement(St.a,{badgeContent:17,color:"secondary"},r.a.createElement(_t.a,null))),r.a.createElement(xe.a,{color:"inherit",onClick:this.handleClickMessage},r.a.createElement(St.a,{badgeContent:4,color:"secondary"},r.a.createElement(bt.a,null))),r.a.createElement(xe.a,{color:"inherit"},r.a.createElement(St.a,{badgeContent:17,color:"secondary"},r.a.createElement(kt.a,null))),r.a.createElement(xe.a,{color:"inherit"},r.a.createElement(Oe.a,null))))),r.a.createElement(Bt,null))}}]),t}(r.a.Component),Wt=Object(Ee.withStyles)(Kt)(Ht),qt=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,"lalalaakakkaka")}}]),t}(n.Component),Vt=(a(1663),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).onClickGoTo=function(){a.props.history.push("/login")},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{id:"background"},r.a.createElement(M.a,null),r.a.createElement("div",{id:"wrapper"},r.a.createElement(z.a,{variant:"h2",style:{color:"black"}},"Justice Music"),r.a.createElement("img",{src:me.a,alt:"Justice Music",style:{height:"100px",width:"100px",margin:"50px"}}),r.a.createElement(z.a,{variant:"h4",style:{marginBottom:"50px",color:"#e0e0e0"}},"A safe place for all your music Intellectual"),r.a.createElement(F.a,{variant:"contained",color:"secondary",style:{padding:"15px",opacity:"0.8"},onClick:this.onClickGoTo},r.a.createElement(z.a,{style:{color:"white"}},"Getting started"))))}}]),t}(n.Component)),Jt=function(){return r.a.createElement(O.a,null,r.a.createElement("div",null,r.a.createElement(j.a,{exact:!0,path:"/",component:Vt}),r.a.createElement(j.a,{path:"/home",component:Wt}),r.a.createElement(j.a,{path:"/login",component:he}),r.a.createElement(j.a,{path:"/message",component:Et}),r.a.createElement(j.a,{path:"/fileManager",component:qt})))},zt=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(m.a,{store:_},r.a.createElement(Jt,null))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(zt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},181:function(e,t,a){e.exports=a.p+"static/media/logo.3188ed62.png"},351:function(e,t){},588:function(e,t){},62:function(e,t,a){var n={api_url:"http://localhost:6969/api",url:"http://localhost:6969/chat",provider:a(805).getDefaultProvider("ropsten")};e.exports=n},627:function(e,t){},690:function(e,t,a){"use strict";(function(e){a.d(t,"a",function(){return s});var n=a(225),r=a.n(n),i=a(415),c=a(691);function s(e){return o.apply(this,arguments)}function o(){return(o=Object(i.a)(r.a.mark(function t(a){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t,n){var s=new FileReader;s.readAsArrayBuffer(a),s.onloadend=Object(i.a)(r.a.mark(function a(){var i;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.from(s.result);case 2:i=a.sent,c.a.add(i,function(e,a){return e?n(e):(console.log(a[0].hash),t(a[0].hash))});case 4:case"end":return a.stop()}},a)}))}));case 1:case"end":return t.stop()}},t)}))).apply(this,arguments)}}).call(this,a(2).Buffer)},691:function(e,t,a){"use strict";var n=new(a(961))({host:"ipfs.infura.io",port:5001,protocol:"https"});t.a=n},778:function(e,t,a){e.exports=a(1665)},922:function(e,t,a){e.exports=a.p+"static/media/login-background.43901f8b.png"},946:function(e,t){},974:function(e,t){},976:function(e,t){},982:function(e,t){},984:function(e,t){}},[[778,1,2]]]);
//# sourceMappingURL=main.06628079.chunk.js.map